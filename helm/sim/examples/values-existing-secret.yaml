# Example: Using Pre-Existing Kubernetes Secrets
#
# This example shows how to use pre-existing Kubernetes secrets instead of
# having the Helm chart create them. This is useful when:
#
# 1. You manage secrets via GitOps tools (Flux, ArgoCD) with sealed secrets
# 2. You use External Secrets Operator to sync from external stores
# 3. You create secrets manually or via other automation
# 4. You want full control over secret lifecycle
#
# Prerequisites:
# Create your secrets before installing the Helm chart.

# =============================================================================
# SECRET CONFIGURATION
# =============================================================================

# Use existing secret for app credentials
app:
  enabled: true
  replicaCount: 2
  secrets:
    existingSecret:
      enabled: true
      name: "sim-app-secrets"  # Name of your pre-existing secret
      # Optional: Customize key names if your secret uses different keys
      keys:
        BETTER_AUTH_SECRET: "BETTER_AUTH_SECRET"
        ENCRYPTION_KEY: "ENCRYPTION_KEY"
        INTERNAL_API_SECRET: "INTERNAL_API_SECRET"
        CRON_SECRET: "CRON_SECRET"
        API_ENCRYPTION_KEY: "API_ENCRYPTION_KEY"
  env:
    NEXT_PUBLIC_APP_URL: "https://sim.example.com"
    BETTER_AUTH_URL: "https://sim.example.com"
    NEXT_PUBLIC_SOCKET_URL: "wss://sim-ws.example.com"
    NODE_ENV: "production"

realtime:
  enabled: true
  replicaCount: 2
  env:
    NEXT_PUBLIC_APP_URL: "https://sim.example.com"
    BETTER_AUTH_URL: "https://sim.example.com"
    NEXT_PUBLIC_SOCKET_URL: "wss://sim-ws.example.com"
    ALLOWED_ORIGINS: "https://sim.example.com"
    NODE_ENV: "production"

# Use existing secret for PostgreSQL
postgresql:
  enabled: true
  auth:
    username: postgres
    database: sim
    existingSecret:
      enabled: true
      name: "sim-postgresql-secret"  # Name of your pre-existing secret
      passwordKey: "POSTGRES_PASSWORD"  # Key containing the password

# =============================================================================
# EXAMPLE: CREATING THE REQUIRED SECRETS
# =============================================================================
# Run these commands before installing the Helm chart:
#
# # Generate secure values
# BETTER_AUTH_SECRET=$(openssl rand -hex 32)
# ENCRYPTION_KEY=$(openssl rand -hex 32)
# INTERNAL_API_SECRET=$(openssl rand -hex 32)
# CRON_SECRET=$(openssl rand -hex 32)
# API_ENCRYPTION_KEY=$(openssl rand -hex 32)
# POSTGRES_PASSWORD=$(openssl rand -base64 16 | tr -d '/+=')
#
# # Create app secrets
# kubectl create secret generic sim-app-secrets \
#   --namespace sim \
#   --from-literal=BETTER_AUTH_SECRET="$BETTER_AUTH_SECRET" \
#   --from-literal=ENCRYPTION_KEY="$ENCRYPTION_KEY" \
#   --from-literal=INTERNAL_API_SECRET="$INTERNAL_API_SECRET" \
#   --from-literal=CRON_SECRET="$CRON_SECRET" \
#   --from-literal=API_ENCRYPTION_KEY="$API_ENCRYPTION_KEY"
#
# # Create PostgreSQL secret
# kubectl create secret generic sim-postgresql-secret \
#   --namespace sim \
#   --from-literal=POSTGRES_PASSWORD="$POSTGRES_PASSWORD"

# =============================================================================
# EXAMPLE: USING SEALED SECRETS (GitOps)
# =============================================================================
# If using Bitnami Sealed Secrets, create a SealedSecret:
#
# apiVersion: bitnami.com/v1alpha1
# kind: SealedSecret
# metadata:
#   name: sim-app-secrets
#   namespace: sim
# spec:
#   encryptedData:
#     BETTER_AUTH_SECRET: <sealed-value>
#     ENCRYPTION_KEY: <sealed-value>
#     INTERNAL_API_SECRET: <sealed-value>
#     CRON_SECRET: <sealed-value>
#     API_ENCRYPTION_KEY: <sealed-value>
#   template:
#     metadata:
#       name: sim-app-secrets
#       namespace: sim
#     type: Opaque

# =============================================================================
# EXAMPLE: EXTERNAL DATABASE WITH EXISTING SECRET
# =============================================================================
# If using an external database (e.g., AWS RDS, Azure Database), you can also
# use existing secrets:
#
# externalDatabase:
#   enabled: true
#   host: "mydb.cluster-xyz.us-east-1.rds.amazonaws.com"
#   port: 5432
#   username: postgres
#   database: sim
#   sslMode: require
#   existingSecret:
#     enabled: true
#     name: "sim-external-db-secret"
#     passwordKey: "EXTERNAL_DB_PASSWORD"

---
title: MCP（モデルコンテキストプロトコル）
---

import { Video } from '@/components/ui/video'
import { Callout } from 'fumadocs-ui/components/callout'

モデルコンテキストプロトコル（[MCP](https://modelcontextprotocol.com/)）を使用すると、標準化されたプロトコルを使用して外部ツールやサービスを接続し、APIやサービスをワークフローに直接統合することができます。MCPを使用することで、エージェントやワークフローとシームレスに連携するカスタム統合機能を追加して、Simの機能を拡張できます。

## MCPとは？

MCPは、AIアシスタントが外部データソースやツールに安全に接続できるようにするオープンスタンダードです。以下のような標準化された方法を提供します：

- データベース、API、ファイルシステムへの接続
- 外部サービスからのリアルタイムデータへのアクセス
- カスタムツールやスクリプトの実行
- 外部リソースへの安全で制御されたアクセスの維持

## MCPサーバーの追加

MCPサーバーは、エージェントが使用できるツールのコレクションを提供します。MCPサーバーを追加するには2つの方法があります：

### ワークスペース設定から

ワークスペースレベルでMCPサーバーを設定すると、すべてのチームメンバーが使用できるようになります：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-1.mp4" width={700} height={450} />
</div>

1. ワークスペース設定に移動します
2. **MCPサーバー**セクションに移動します
3. **MCPサーバーを追加**をクリックします
4. サーバー設定の詳細を入力します
5. 設定を保存します

<Callout type="info">
ワークスペース設定で構成されたMCPサーバーは、権限レベルに基づいてすべてのワークスペースメンバーが利用できます。
</Callout>

### エージェント設定から

エージェントブロック内から直接MCPサーバーを追加および設定することもできます：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-2.mp4" width={700} height={450} />
</div>

これは、特定のワークフロー用に特定の統合を迅速にセットアップする必要がある場合に便利です。

## エージェントでのMCPツールの使用

MCPサーバーが設定されると、そのツールはエージェントブロック内で利用可能になります：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-3.mp4" width={700} height={450} />
</div>

1. **エージェント**ブロックを開く
2. **ツール**セクションで、利用可能なMCPツールが表示されます
3. エージェントに使用させたいツールを選択します
4. これでエージェントは実行中にこれらのツールにアクセスできるようになります

## スタンドアロンMCPツールブロック

より細かい制御が必要な場合は、専用のMCPツールブロックを使用して特定のMCPツールを実行できます：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-4.mp4" width={700} height={450} />
</div>

MCPツールブロックでは以下のことが可能です：
- 設定されたMCPツールを直接実行する
- ツールに特定のパラメータを渡す
- ツールの出力を後続のワークフローステップで使用する
- 複数のMCPツールを連携させる

### MCPツールとエージェントの使い分け

**MCPツールを備えたエージェントを使用する場合：**
- AIにどのツールを使用するか決定させたい場合
- ツールをいつどのように使用するかについて複雑な推論が必要な場合
- ツールと自然言語でのやり取りが必要な場合

**MCPツールブロックを使用する場合：**
- 決定論的なツール実行が必要な場合
- 既知のパラメータで特定のツールを実行したい場合
- 予測可能なステップで構造化されたワークフローを構築している場合

## 権限要件

MCP機能には特定のワークスペース権限が必要です：

| アクション | 必要な権限 |
|--------|-------------------|
| 設定でMCPサーバーを構成する | **管理者** |
| エージェントでMCPツールを使用する | **書き込み**または**管理者** |
| 利用可能なMCPツールを表示する | **読み取り**、**書き込み**、または**管理者** |
| MCPツールブロックを実行する | **書き込み**または**管理者** |

## 一般的なユースケース

### データベース統合
ワークフロー内でデータのクエリ、挿入、更新を行うためにデータベースに接続します。

### API統合
Simに組み込まれていない外部APIやウェブサービスにアクセスします。

### ファイルシステムアクセス
ローカルまたはリモートのファイルシステム上でファイルの読み取り、書き込み、操作を行います。

### カスタムビジネスロジック
組織固有のニーズに合わせたカスタムスクリプトやツールを実行します。

### リアルタイムデータアクセス
ワークフロー実行中に外部システムからライブデータを取得します。

## セキュリティに関する考慮事項

- MCPサーバーは設定したユーザーの権限で実行されます
- インストール前に必ずMCPサーバーのソースを確認してください
- 機密性の高い設定データには環境変数を使用してください
- エージェントにアクセス権を付与する前にMCPサーバーの機能を確認してください

## トラブルシューティング

### MCPサーバーが表示されない場合
- サーバー設定が正しいことを確認してください
- 必要な権限を持っていることを確認してください
- MCPサーバーが実行中でアクセス可能であることを確認してください

### ツール実行の失敗
- ツールパラメータが正しくフォーマットされていることを確認してください
- エラーメッセージについてMCPサーバーログを確認してください
- 必要な認証が設定されていることを確認してください

### 権限エラー
- ワークスペースの権限レベルを確認してください
- MCPサーバーが追加の認証を必要としているか確認してください
- サーバーがワークスペース用に適切に設定されていることを確認してください
---
title: MCP（模型上下文协议）
---

import { Video } from '@/components/ui/video'
import { Callout } from 'fumadocs-ui/components/callout'

模型上下文协议（[MCP](https://modelcontextprotocol.com/)）允许您使用标准化协议连接外部工具和服务，从而将 API 和服务直接集成到您的工作流程中。通过 MCP，您可以通过添加自定义集成来扩展 Sim 的功能，使其与您的代理和工作流程无缝协作。

## 什么是 MCP？

MCP 是一项开放标准，使 AI 助手能够安全地连接到外部数据源和工具。它提供了一种标准化的方法来：

- 连接数据库、API 和文件系统
- 访问外部服务的实时数据
- 执行自定义工具和脚本
- 维护对外部资源的安全、受控访问

## 添加 MCP 服务器

MCP 服务器提供您的代理可以使用的工具集合。您可以通过以下两种方式添加 MCP 服务器：

### 从工作区设置中添加

在工作区级别配置 MCP 服务器，以便所有团队成员都可以使用：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-1.mp4" width={700} height={450} />
</div>

1. 导航到您的工作区设置
2. 转到 **MCP 服务器** 部分
3. 点击 **添加 MCP 服务器**
4. 输入服务器配置详情
5. 保存配置

<Callout type="info">
在工作区设置中配置的 MCP 服务器将根据权限级别对所有工作区成员可用。
</Callout>

### 从代理配置中添加

您还可以直接从代理模块中添加和配置 MCP 服务器：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-2.mp4" width={700} height={450} />
</div>

这在您需要为特定工作流程快速设置特定集成时非常有用。

## 在代理中使用 MCP 工具

一旦配置了 MCP 服务器，其工具就可以在您的代理模块中使用：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-3.mp4" width={700} height={450} />
</div>

1. 打开一个 **代理（Agent）** 模块
2. 在 **工具（Tools）** 部分，您将看到可用的 MCP 工具
3. 选择您希望代理使用的工具
4. 代理现在可以在执行过程中访问这些工具

## 独立的 MCP 工具模块

为了更精细的控制，您可以使用专用的 MCP 工具模块来执行特定的 MCP 工具：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp-4.mp4" width={700} height={450} />
</div>

MCP 工具模块允许您：
- 直接执行任何已配置的 MCP 工具
- 向工具传递特定参数
- 在后续工作流步骤中使用工具的输出
- 将多个 MCP 工具串联在一起

### 何时使用 MCP 工具与代理

**在以下情况下使用带有 MCP 工具的代理：**
- 您希望 AI 决定使用哪些工具
- 您需要对何时以及如何使用工具进行复杂推理
- 您希望与工具进行自然语言交互

**在以下情况下使用 MCP 工具模块：**
- 您需要确定性的工具执行
- 您希望使用已知参数执行特定工具
- 您正在构建具有可预测步骤的结构化工作流

## 权限要求

MCP 功能需要特定的工作区权限：

| 操作 | 所需权限 |
|--------|-------------------|
| 在设置中配置 MCP 服务器 | **管理员（Admin）** |
| 在代理中使用 MCP 工具 | **写入（Write）** 或 **管理员（Admin）** |
| 查看可用的 MCP 工具 | **读取（Read）**、**写入（Write）** 或 **管理员（Admin）** |
| 执行 MCP 工具模块 | **写入（Write）** 或 **管理员（Admin）** |

## 常见用例

### 数据库集成
连接数据库以在工作流中查询、插入或更新数据。

### API 集成
访问没有内置 Sim 集成的外部 API 和网络服务。

### 文件系统访问
读取、写入和操作本地或远程文件系统上的文件。

### 自定义业务逻辑
执行特定于您组织需求的自定义脚本或工具。

### 实时数据访问
在工作流执行期间从外部系统获取实时数据。

## 安全注意事项

- MCP 服务器以配置它的用户权限运行
- 安装前始终验证 MCP 服务器来源
- 对于敏感的配置数据，请使用环境变量
- 在授予代理访问权限之前，审查 MCP 服务器的功能

## 故障排除

### MCP 服务器未显示
- 验证服务器配置是否正确
- 检查您是否拥有所需的权限
- 确保 MCP 服务器正在运行且可访问

### 工具执行失败
- 验证工具参数格式是否正确
- 检查 MCP 服务器日志中的错误消息
- 确保已配置所需的身份验证

### 权限错误
- 确认您的工作区权限级别
- 检查 MCP 服务器是否需要额外的身份验证
- 验证服务器是否已正确配置以适应您的工作区